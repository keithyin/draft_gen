// Author: Lance Hepler

#include "../UnanimityInternalConfig.h"

#include <cassert>
#include <cmath>
#include <memory>
#include <random>
#include <stdexcept>

#include <pacbio/consensus/ModelConfig.h>
#include <pacbio/data/Read.h>
#include <pacbio/data/internal/BaseEncoding.h>

#include "../ModelFactory.h"
#include "../Recursor.h"
#include "../Simulator.h"
#include "CounterWeight.h"
#include "HelperFunctions.h"

using namespace PacBio::Data;

namespace PacBio {
namespace Consensus {
namespace Kit__500_Chem__1_BC__1_PW3__nodel_dbscan {
namespace {

static constexpr const size_t CONTEXT_NUMBER = 16;
static constexpr const size_t OUTCOME_NUMBER = 64; // 4cr, 4pw, 4base

class Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model : public ModelConfig
{
public:
    static std::set<std::string> Chemistries() { return {"Kit__500_Chem__1_BC__1_PW3__nodel_dbscan"}; }
    static ModelForm Form() { return ModelForm::PWSNR; }
    Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model(const NucleotideLevelFeats& feats);
    std::unique_ptr<AbstractRecursor> CreateRecursor(const MappedRead& mr,
                                                     double scoreDiff) const override;
    std::vector<TemplatePosition> Populate(const std::string& tpl) const override;
    std::pair<Data::Read, std::vector<MoveType>> SimulateRead(
        std::default_random_engine* const rng, const std::string& tpl,
        const std::string& readname) const override;

    double ExpectedLLForEmission(MoveType move, const AlleleRep& prev, const AlleleRep& curr,
                                 MomentType moment) const override;

private:
    double ctxTrans_[CONTEXT_NUMBER][4];
    double cachedEmissionExpectations_[CONTEXT_NUMBER][3][2];
};

// TODO(lhepler) comments regarding the CRTP
class Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor : public Recursor<Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor>
{
public:
    Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor(const MappedRead& mr, double scoreDiff, double counterWeight);
    static inline std::vector<uint8_t> EncodeRead(const MappedRead& read);
    inline double EmissionPr(MoveType move, uint8_t emission, const AlleleRep& prev,
                             const AlleleRep& curr) const;
    double UndoCounterWeights(size_t nEmissions) const override;

private:
    double counterWeight_;
    double nLgCounterWeight_;
};

static constexpr const double snrRanges[2][4] = {
    {3.91070819, 7.37540293, 3.84641552, 6.27542830},  // minimum
    {8.06702614, 15.2471046, 7.02776623, 11.3469543}   // maximum
};

static constexpr const double emissionPmf[3][CONTEXT_NUMBER][OUTCOME_NUMBER] = {
	{
		// match
{0.39369528614403665,0.0028861663567731973,0.0024274365657807185,0.004572482275878228,0.41357138692072765,0.0015082471122726162,0.0010980792588718212,0.0029001886099760486,0.17463895114550324,0.0012025745459448166,0.0003626428344434493,0.001119716461754932,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905,0.0000003238801545510905},
{0.005395025264905718,0.2851322424011355,0.0017887192258084705,0.0019059623570355402,0.00480230028436165,0.3953823434445364,0.0008015264482098608,0.0009172705867497492,0.0033404744021638994,0.2997041830335507,0.00036617858803116216,0.00044081678783649707,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877,0.00000044148414759448877},
{0.006262112924434967,0.0023507028132030644,0.5264952748254382,0.003668024663410789,0.005917706672326045,0.0015426042793665082,0.36686545533995857,0.0009278296887318159,0.0035344870804463217,0.001313851381949891,0.08052964324982041,0.0005670028406159915,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737,0.0000004866200057179737},
{0.005890934104881234,0.0013205215366311042,0.0031141406791219614,0.52840630597066,0.005492331331594374,0.0011161128496025867,0.0017632057666397392,0.35977865082636235,0.0042263362789146264,0.001594402342775564,0.0009068243718577633,0.08637066810944354,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383,0.00000037626599067749383},
{0.32887192462792564,0.003081727706164987,0.002537341066063858,0.003312387296814095,0.39743719647454895,0.003656890635813327,0.0010007085962569244,0.0023165760952886406,0.25078445738620536,0.005196486642676753,0.0003574755878278434,0.001427694673080647,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895,0.00000036794637178778895},
{0.0036880287429307376,0.20739324001320603,0.0026135495395624726,0.0016158587571142636,0.0018110077483549944,0.3211903088474231,0.0011218830668939387,0.000936696325724749,0.0009492385914102812,0.45768840148927414,0.0004677078670165666,0.000503024577100052,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311,0.0000004048929613197311},
{0.00441702209840986,0.0033472273440459037,0.4469923258947702,0.0022105420641484364,0.0014267919086252269,0.003951038440081241,0.37146242855569256,0.0008635098591839981,0.0007730944968914873,0.004922444990436071,0.15919554517234435,0.00042054002486864383,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813,0.00000033632981734576813},
{0.0020592051179794692,0.002111967948734056,0.002497132079054847,0.393748885463604,0.001222734394407563,0.0028193238993386906,0.0019007201442491357,0.3794882681766469,0.000869812117053607,0.0042028292537703805,0.0013024567494699392,0.20775131854650342,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435,0.0000004874251766930435},
{0.3510048036903895,0.001979389435713237,0.004718008987147249,0.003370630808251108,0.38673274574469485,0.0009399547921074562,0.0035433488487379553,0.0024410257195189348,0.24090639222220275,0.0009634721187656261,0.0019681489507681455,0.0014088282429083284,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307,0.0000004471238229777307},
{0.0017576592078253576,0.1961996044988559,0.0033732609156160165,0.0027168715485795802,0.0009884133140694276,0.3151602134669506,0.002355687510048268,0.0009034540849489587,0.0008448182034774922,0.4737877566376212,0.0013437557952104694,0.0005532695263714099,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906,0.00000029298635433315906},
{0.0032974769809396044,0.0020945392597928676,0.41014133433971245,0.0038413939219690326,0.0018905110012149698,0.0017500554880635207,0.3774534774985733,0.001749051492529532,0.001269575957639345,0.002399521000340109,0.19300525627541507,0.0010866945517036724,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941,0.0000004060044635878941},
{0.002377359645233542,0.0012691890307758198,0.003981096662929981,0.3731400390182917,0.0018299792299861716,0.00132526979222724,0.003425440495294028,0.3794914038147283,0.0019722761946676395,0.002510938508808687,0.002339982920114904,0.22631366031529954,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417,0.00000044931483927912417},
{0.1644978748748628,0.0010893737939125904,0.0016565199835464391,0.004237667723559254,0.3268051224745957,0.0006728732506227963,0.0009019377693166615,0.004108099359082892,0.49102122237791057,0.0006640163077103082,0.0006929285775390489,0.003623438301373575,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958,0.0000005562539609108958},
{0.001345155186075046,0.12103014359388885,0.0010889803834045165,0.002228833278527809,0.0007690301505446067,0.2557817434641944,0.0005876760653070131,0.0020533373776310147,0.0005676214287092342,0.6126289285630145,0.00043652064478139985,0.0014602829350017072,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725,0.0000004182101715346725},
{0.0014847332177372742,0.0009140315038205702,0.23040710360861463,0.002744454473636421,0.0010729347204224613,0.0008502691733297982,0.37388086854584757,0.001980598932497257,0.001028699654447348,0.0011856926835255067,0.3831344428020384,0.0012979954530058754,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776,0.00000034952367455528776},
{0.001875193013895764,0.0009452258103262631,0.0019783057916146238,0.2811033883501515,0.0017160447481281728,0.001084782224477083,0.0016527614218699795,0.3733262305682391,0.002050158371373306,0.002245092059163742,0.0015861446385474413,0.3304199483724542,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288,0.0000003216274953631288} 

		},

{ // branch
  
{0.4971878600736975,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.3364604684237946,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.16363131633869027,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265,0.00004459598629209265},
{0.000012757822993216696,0.4942552709835777,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.2951660806474407,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.20980042116639533,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696,0.000012757822993216696},
{0.000021777132154273254,0.000021777132154273254,0.6458903259732817,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.26932775343559584,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.08345351552971186,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254,0.000021777132154273254},
{0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.5571992336164776,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.31344055475138377,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.12830700312054347,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215,0.000017265713304838215},
{0.41175530753438355,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.34336071298064086,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.2445625156130987,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494,0.000005269899538965494},
{0.0000789236043981861,0.4699472374291217,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.2671031733407077,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.25813524936188126,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861,0.0000789236043981861},
{0.000011721347053548657,0.000011721347053548657,0.5641728758761139,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.3007539552050095,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.1343581667486101,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657,0.000011721347053548657},
{0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.4294407625124889,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.3412619118046653,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.22826786160726958,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386,0.000016876460255347386},
{0.4182348914907633,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.3450663798740109,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.2362050927987069,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495,0.00000809239076260495},
{0.000010088167455446664,0.4392079208849935,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.2662857040970003,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.29389099680322395,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664,0.000010088167455446664},
{0.00007428851470768621,0.00007428851470768621,0.592440538954536,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.27737661339969005,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.12565124824860507,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621,0.00007428851470768621},
{0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.4047215935045456,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.3553766418760853,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.23895855825231255,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736,0.000015462399459942736},
{0.27327829308434565,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.3076160494413069,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.4187214479440762,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756,0.000006298516889692756},
{0.000008535730501711712,0.24730241140341835,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.23883675329396487,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.5133401557420124,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712,0.000008535730501711712},
{0.000010062049304041589,0.000010062049304041589,0.43249339921765617,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.3010585431868616,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.2658342725879357,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589,0.000010062049304041589},
{0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.39660122857791863,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.3401173669408279,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.25899494547552243,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321,0.00007026981976608321} 

	},


    {// stickPmf

{0.00001341987383446055,0.3059512771194584,0.2583562901601428,0.15465447517942318,0.00001341987383446055,0.05465873000763893,0.0683169366401983,0.06348931908080314,0.00001341987383446055,0.03751593349942768,0.025940408061952795,0.03037853719005943,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055,0.00001341987383446055},
{0.11750708784543655,0.00001616070100861566,0.32798593693292694,0.24452130312376327,0.07313706892739423,0.00001616070100861566,0.07320822612253294,0.06748821490274703,0.04494403699572819,0.00001616070100861566,0.023115941003168626,0.027203345590828338,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566,0.00001616070100861566},
{0.11889179707267003,0.16798805354706983,0.000016837387771958076,0.4557669423604008,0.06471182419261136,0.056442186871249196,0.000016837387771958076,0.04094082624063812,0.03652186034600701,0.03631367714060955,0.000016837387771958076,0.02149677590128644,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076,0.000016837387771958076},
{0.15925663458111688,0.17149831743836766,0.22395991578159052,0.000026482485428474298,0.09941853494784798,0.07220500974719696,0.08560761086102156,0.000026482485428474298,0.06657696836718438,0.07322037697920653,0.04680009459790144,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298,0.000026482485428474298},
{0.000016374768436656428,0.17639255981296714,0.3435615552932772,0.13830624472738803,0.000016374768436656428,0.09156275458639493,0.055583961053946106,0.050309889319258984,0.000016374768436656428,0.09778364335805119,0.018973406106696976,0.026625373478003353,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428,0.000016374768436656428},
{0.28074236126864266,0.00002066600279135219,0.30227201073478693,0.15633238365841437,0.06569449944698418,0.00002066600279135219,0.073004977783246,0.04311536948249766,0.02913505889650594,0.00002066600279135219,0.028197399095437843,0.020369309479960063,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219,0.00002066600279135219},
{0.5272739116362661,0.0964495241807381,0.000011448309683699177,0.18937651884236467,0.03663849583765196,0.046766700044257925,0.000011448309683699177,0.029343260171534727,0.016949976832703544,0.04244669369710204,0.000011448309683699177,0.014125261724777488,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177,0.000011448309683699177},
{0.3158326122158623,0.13005567099048462,0.21033462978105694,0.00003103391284955553,0.049078810020249025,0.06824910753443261,0.07493535202922096,0.00003103391284955553,0.033793284790519885,0.0688038687982394,0.04720979863320874,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553,0.00003103391284955553},
{0.000022966642109569756,0.3528448904206314,0.19926553034605565,0.15980492241013722,0.000022966642109569756,0.05144510028945091,0.08076210796030937,0.05346082371553268,0.000022966642109569756,0.03752695909908094,0.038289843296286416,0.025336657146489076,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756,0.000022966642109569756},
{0.23683327759163836,0.000009226704859025963,0.11058084181308041,0.42288942344967756,0.057447753247299435,0.000009226704859025963,0.03792211459481605,0.0780258799773066,0.01806524439037802,0.000009226704859025963,0.01617369836943383,0.021554297799123334,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963,0.000009226704859025963},
{0.2898507459772006,0.16113922808531786,0.0000157440952320045,0.31084238476420717,0.053440219060167826,0.04716650222833869,0.0000157440952320045,0.04148984054282711,0.02912523365945986,0.045883663585054975,0.0000157440952320045,0.020196256859665678,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045,0.0000157440952320045},
{0.3416950510919655,0.16233243506951567,0.16072362204631058,0.000030587602062410564,0.06501074715553085,0.0519903874311038,0.06826749687899758,0.000030587602062410564,0.054800653009737056,0.05853969097037389,0.034957598233032475,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564,0.000030587602062410564},
{0.000024879248854975967,0.1896969437482112,0.2913489258721816,0.15922237111199056,0.000024879248854975967,0.06038540849412271,0.068988999900483,0.10067976279468409,0.000024879248854975967,0.04100273787454841,0.02884623544178217,0.05846025607497256,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967,0.000024879248854975967},
{0.21040928468569714,0.00002386780124449306,0.34742193517542186,0.1067904634627443,0.0674034108013087,0.00002386780124449306,0.08698888445042352,0.06639615258444807,0.03511416117352613,0.00002386780124449306,0.03757328478856921,0.04058969380941394,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306,0.00002386780124449306},
{0.32457212612307645,0.16627417114556042,0.000021448145533481884,0.15840253547007851,0.07537227496323057,0.060786205882910414,0.000021448145533481884,0.07826927099249714,0.043313615449049346,0.055611217280355195,0.000021448145533481884,0.036218934688900466,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884,0.000021448145533481884},
{0.24362324017084067,0.1153514856467403,0.20577577196337174,0.00002121365804372579,0.09032200030652913,0.055832210160585746,0.08026804196949575,0.00002121365804372579,0.08331869755375278,0.06913218707223234,0.05520961396404663,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579,0.00002121365804372579} 

}};

static constexpr const double transProbs[CONTEXT_NUMBER][4] = {
{0.9527470413580916,0.006955902324934992,0.023161621631191013,0.01713543468578237}, // AA
{0.9000425917172657,0.03141078756063187,0.02479137030467667,0.04375525041742572}, // AC
{0.8900986182911452,0.020099391905450088,0.026004371410107512,0.06379761839329715}, // AG
{0.8974230495583897,0.019677050393509685,0.012821216777683877,0.0700786832704167}, // AT
{0.8401205428548502,0.05872485250463022,0.018886010712908304,0.08226859392761128}, // CA
{0.9656216258157599,0.004937477995774794,0.01892692409238301,0.010513972096082215}, // CC
{0.8768254028515844,0.025169549128744757,0.025770282937274635,0.07223476508239625}, // CG
{0.9008852944249958,0.02601739814453793,0.01413561080675109,0.05896169662371522}, // CT
{0.8485002596132243,0.04692717374491217,0.016519233917863727,0.08805333272399987}, // GA
{0.905681171994814,0.02632083951926517,0.028779904605910567,0.039218083880010225}, // GC
{0.9574667310328163,0.005215388523324223,0.024701457025858197,0.012616423418001224}, // GG
{0.9042929094196324,0.02628920123352182,0.013276629163504411,0.05614126018334139}, // GT
{0.8413911964183274,0.07439822329125462,0.018812505241379687,0.06539807504903834}, // TA
{0.9087242111493489,0.04458677730423337,0.015929706352317084,0.03075930519410062}, // TC
{0.9127085081155906,0.03172193886526222,0.014870981137928542,0.04069857188121872}, // TG
{0.973586427935591,0.004442476303784844,0.014762024053972419,0.0072090717066517086}, // TT
    };

inline double CalculateExpectedLLForEmission(const size_t move, const uint8_t row,
                                             const size_t moment)
{
    double expectedLL = 0;
    for (size_t i = 0; i < OUTCOME_NUMBER; i++) {
        double curProb = emissionPmf[move][row][i];
        double lgCurProb = std::log(curProb);
        if (!std::isfinite(lgCurProb)) continue;
        if (moment == static_cast<uint8_t>(MomentType::FIRST))
            expectedLL += curProb * lgCurProb;
        else if (moment == static_cast<uint8_t>(MomentType::SECOND))
            expectedLL += curProb * (lgCurProb * lgCurProb);
    }
    return expectedLL;
}

Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model::Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model(const NucleotideLevelFeats& feats){
    for (size_t ctx = 0; ctx < CONTEXT_NUMBER; ++ctx) {
        const uint8_t bp = ctx & 3;  // (equivalent to % 4)
        double sum = 0.0;

        // cached transitions
        for (size_t j = 0; j < 4; ++j) {
            double xb = transProbs[ctx][j];
            ctxTrans_[ctx][j] = xb;
            sum += xb;
        }
        for (size_t j = 0; j < 4; ++j)
            ctxTrans_[ctx][j] /= sum;

        // cached expectations
        for (size_t move = 0; move < 3; ++move)
            for (size_t moment = 0; moment < 2; ++moment)
                cachedEmissionExpectations_[ctx][move][moment] =
                    CalculateExpectedLLForEmission(move, ctx, moment);
    }
}

std::unique_ptr<AbstractRecursor> Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model::CreateRecursor(const MappedRead& mr,
                                                                 double scoreDiff) const
{
    const double counterWeight = CounterWeight(
        [this](size_t ctx, MoveType m) { return ctxTrans_[ctx][static_cast<uint8_t>(m)]; },
        [](size_t ctx, MoveType m) {
            double r = 0.0;
            for (size_t o = 0; o < OUTCOME_NUMBER; ++o) {
                const double p = emissionPmf[static_cast<uint8_t>(m)][ctx][o];
                if (p > 0.0) r += p * std::log(p);
            }
            return r;
        },
        CONTEXT_NUMBER);

    return std::make_unique<Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor>(mr, scoreDiff, counterWeight);
}

std::vector<TemplatePosition> Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model::Populate(const std::string& tpl) const
{
    auto rowFetcher = [this](const NCBI2na prev, const NCBI2na curr) -> const double(&)[4]
    {
        const auto row = EncodeContext16(prev, curr);
        const double(&params)[4] = ctxTrans_[row];
        return params;
    };
    return AbstractPopulater(tpl, rowFetcher);
}

double Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model::ExpectedLLForEmission(const MoveType move, const AlleleRep& prev,
                                             const AlleleRep& curr, const MomentType moment) const
{
    auto cachedEmissionVisitor = [this](const MoveType move, const NCBI2na prev, const NCBI2na curr,
                                        const MomentType moment) -> double {
        const auto row = EncodeContext16(prev, curr);
        return cachedEmissionExpectations_[row][static_cast<uint8_t>(move)]
                                          [static_cast<uint8_t>(moment)];
    };
    return AbstractExpectedLLForEmission(move, prev, curr, moment, cachedEmissionVisitor);
}

Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor::Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor(const MappedRead& mr, double scoreDiff, double counterWeight)
    : Recursor<Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor>(mr, scoreDiff)
    , counterWeight_{counterWeight}
    , nLgCounterWeight_{-std::log(counterWeight_)}
{
}

std::vector<uint8_t> Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor::EncodeRead(const MappedRead& read)
{
    std::vector<uint8_t> result;
    result.reserve(read.Length());
    std::vector<uint8_t> pw_boundaries = {18, 46};
    std::vector<uint8_t> cr_boundaries = {255};
    for (size_t i = 0; i < read.Length(); ++i) {
        result.emplace_back(EncodeBaseV3(read.Seq[i], read.PulseWidth[i], pw_boundaries, read.CR[i], cr_boundaries));
    }

    return result;
}

double Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor::EmissionPr(const MoveType move, const uint8_t emission,
                                     const AlleleRep& prev, const AlleleRep& curr) const
{
    return AbstractEmissionPrV2(emissionPmf, move, emission, prev, curr) * counterWeight_;
}

double Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Recursor::UndoCounterWeights(const size_t nEmissions) const
{
    return nLgCounterWeight_ * nEmissions;
}

inline std::pair<Data::SNR, std::vector<TemplatePosition>> Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_InitialiseModel(
    std::default_random_engine* const rng, const std::string& tpl)
{
    Data::SNR snrs{0, 0, 0, 0};
    for (uint8_t i = 0; i < 4; ++i) {
        snrs[i] = std::uniform_real_distribution<double>{snrRanges[0][i], snrRanges[1][i]}(*rng);
    }


    Data::NucleotideLevelFeats feats;

    const Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model model{feats};
    std::vector<TemplatePosition> transModel = model.Populate(tpl);

    return {snrs, transModel};
}

BaseData Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_GenerateReadData(std::default_random_engine* const rng, const MoveType state,
                                   const AlleleRep& prev, const AlleleRep& curr)
{
    // distribution is arbitrary at the moment, as
    // IPD is not a covariate of the consensus HMM
    std::uniform_int_distribution<uint8_t> ipdDistrib(1, 5);

    std::array<double, OUTCOME_NUMBER> emissionDist;
    for (size_t i = 0; i < OUTCOME_NUMBER; ++i) {
        emissionDist[i] = AbstractEmissionPrV2(emissionPmf, state, i, prev, curr);
    }

    std::discrete_distribution<uint8_t> outcomeDistrib(emissionDist.cbegin(), emissionDist.cend());

    const uint8_t event = outcomeDistrib(*rng);
    const std::pair<char, uint8_t> outcome = DecodeEmission(event);

    return {outcome.first, outcome.second, ipdDistrib(*rng)};
}

std::pair<Data::Read, std::vector<MoveType>> Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_Model::SimulateRead(
    std::default_random_engine* const rng, const std::string& tpl,
    const std::string& readname) const
{
    return SimulateReadImpl(rng, tpl, readname, Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_InitialiseModel,
                            Kit__500_Chem__1_BC__1_PW3__nodel_dbscan_GenerateReadData);
}

}  // namespace anonymous
}  // namespace S_P2C2v5

REGISTER_MODEL_IMPL(Kit__500_Chem__1_BC__1_PW3__nodel_dbscan)

}  // namespace Consensus
}  // namespace PacBio
