// Author: Lance Hepler

#include "../UnanimityInternalConfig.h"

#include <cassert>
#include <cmath>
#include <memory>
#include <random>
#include <stdexcept>

#include <pacbio/consensus/ModelConfig.h>
#include <pacbio/data/Read.h>
#include <pacbio/data/internal/BaseEncoding.h>

#include "../ModelFactory.h"
#include "../Recursor.h"
#include "../Simulator.h"
#include "CounterWeight.h"
#include "HelperFunctions.h"

using namespace PacBio::Data;

namespace PacBio {
namespace Consensus {
namespace Kit__500_Chem__1_BC__1_PW3__nodel_sf {
namespace {

static constexpr const size_t CONTEXT_NUMBER = 16;
static constexpr const size_t OUTCOME_NUMBER = 64; // 4cr, 4pw, 4base

class Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model : public ModelConfig
{
public:
    static std::set<std::string> Chemistries() { return {"Kit__500_Chem__1_BC__1_PW3__nodel_sf"}; }
    static ModelForm Form() { return ModelForm::PWSNR; }
    Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model(const NucleotideLevelFeats& feats);
    std::unique_ptr<AbstractRecursor> CreateRecursor(const MappedRead& mr,
                                                     double scoreDiff) const override;
    std::vector<TemplatePosition> Populate(const std::string& tpl) const override;
    std::pair<Data::Read, std::vector<MoveType>> SimulateRead(
        std::default_random_engine* const rng, const std::string& tpl,
        const std::string& readname) const override;

    double ExpectedLLForEmission(MoveType move, const AlleleRep& prev, const AlleleRep& curr,
                                 MomentType moment) const override;

private:
    double ctxTrans_[CONTEXT_NUMBER][4];
    double cachedEmissionExpectations_[CONTEXT_NUMBER][3][2];
};

// TODO(lhepler) comments regarding the CRTP
class Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor : public Recursor<Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor>
{
public:
    Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor(const MappedRead& mr, double scoreDiff, double counterWeight);
    static inline std::vector<uint8_t> EncodeRead(const MappedRead& read);
    inline double EmissionPr(MoveType move, uint8_t emission, const AlleleRep& prev,
                             const AlleleRep& curr) const;
    double UndoCounterWeights(size_t nEmissions) const override;

private:
    double counterWeight_;
    double nLgCounterWeight_;
};

static constexpr const double snrRanges[2][4] = {
    {3.91070819, 7.37540293, 3.84641552, 6.27542830},  // minimum
    {8.06702614, 15.2471046, 7.02776623, 11.3469543}   // maximum
};

static constexpr const double emissionPmf[3][CONTEXT_NUMBER][OUTCOME_NUMBER] = {
	{
		// match

 {0.39430191531692227,0.002830650060184983,0.002397016321668465,0.003611413318032419,0.41445259606209345,0.0014883266079993014,0.0010962049158345754,0.0020656234602935033,0.17545379477232614,0.0011873942085206968,0.0003601244862447689,0.0007382059261938767,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013,0.00000032181814779935013},
{0.005465249468605169,0.2848673787975831,0.0017264320082484162,0.0018417490973233392,0.004900998402502236,0.39541358781420494,0.0007628396762581011,0.0008643422605487397,0.0034210396166821986,0.2999785041541934,0.0003461077862444927,0.00038894636142531593,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723,0.00000043893377270263723},
{0.00635294330860673,0.0023346416214139625,0.5261638823825108,0.0035565664166527728,0.0060191170041348,0.0014983798629135121,0.3671946089948531,0.000855544347506399,0.0036083093437576635,0.0013550906025595188,0.08052638803919653,0.0005093582749500951,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373,0.0000004840346335410373},
{0.006381517085621569,0.0013210382635843114,0.0031464538893796767,0.5272223171316025,0.005868451625170066,0.0011397820515468675,0.001787729438375913,0.3599599183258347,0.004404964569305046,0.0016343210357103117,0.0008965617767661099,0.08621745976430889,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225,0.00000037471236142356225},
{0.3292346887430133,0.0030296634691247028,0.002485419948509361,0.0026504717858320745,0.39829942455948203,0.003637936306321331,0.001001328466560922,0.0016299095748641633,0.2516295948717938,0.005170398500729623,0.0003548461403647367,0.0008572993613693736,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417,0.00000036573600066356417},
{0.0037208146285101266,0.20683135019327234,0.0025422291107601008,0.0015850296964244226,0.0018433363531325088,0.3210321164218342,0.0010832887640081518,0.0009319640805023365,0.0009720905066557726,0.45850480958892786,0.00043367850521500086,0.0004983728947815687,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284,0.00000040229338414496284},
{0.00445567317848533,0.003501968722468638,0.44618069470439026,0.002138336231734193,0.001463902676165508,0.004079284427206585,0.3718046444645518,0.0008494205573126239,0.0007974239007487529,0.005098894729739691,0.15919608856869863,0.00041626383808729433,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855,0.00000033469231559000855},
{0.0023070930519621564,0.0021378972533111136,0.0027660170076711835,0.39234199824976324,0.0014681309800805209,0.0028754937664863104,0.0021358854350180456,0.37953722982375543,0.0010290093330281235,0.004283751530001914,0.0013784377278819014,0.20771383102401225,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104,0.0000004850926351510104},
{0.3514129157291362,0.0019647673003145827,0.004680690122016539,0.0026662996212668735,0.3875746620479699,0.0009421690140368579,0.0035346952935849823,0.0017180017767958297,0.241651918859811,0.000985980333110237,0.001964708733638146,0.0008800814468165675,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493,0.00000044441772119728493},
{0.0017812305029233772,0.19581864066215293,0.003323925138467947,0.00268182293885896,0.0010118303107555123,0.3151344521948246,0.002317727382359423,0.0008994952729863099,0.0008709532335466791,0.4742860696349277,0.0013112948424099029,0.0005474143280423937,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458,0.0000002912222643132458},
{0.0033495935237044306,0.002375865710777779,0.4089184410574738,0.0037654482982876743,0.0019365049179547848,0.00196314194407983,0.37752175120717946,0.001741603586945191,0.0013042352536855662,0.0026575250494940876,0.1933597960114269,0.0010851116199150105,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487,0.00000040349652068234487},
{0.0026465682776679413,0.001345009769167561,0.004252930360298824,0.3717456747623743,0.002130955894803926,0.0014097308292327325,0.003645864079534352,0.37937483220481955,0.0022026305431338254,0.002651733206139748,0.0024050749408589694,0.2261657425546603,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806,0.00000044716494823025806},
{0.1645610471587074,0.001056256559286211,0.0016432219340713936,0.003968221386410741,0.3272776349479558,0.0006651677163181585,0.0009094980744114328,0.003742759180532366,0.4918034998378273,0.0006622922836276754,0.0006938534785090589,0.002987801686026885,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904,0.00000055280300606904},
{0.0013650838678380467,0.12063008261710094,0.0010264201138676585,0.0022257509799052102,0.0007929118019517958,0.2557460404129035,0.0005125574479965023,0.0020677487163480307,0.0005888176222383189,0.6132025759406134,0.00034853829117517736,0.0014718539127449217,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561,0.0000004157360637786561},
{0.0015056858809481496,0.0011017213105858075,0.2300190581089371,0.002708429320027983,0.0011107180002889933,0.0010757632067821255,0.37392549643755335,0.0019674243418812357,0.0010662195485225613,0.0017187099254595563,0.38249148747177414,0.0012912122350410217,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257,0.0000003475810038068257},
{0.0020244041112134127,0.0009574633128303983,0.0021056683560468055,0.2804018604391849,0.001945216701914341,0.0011132606744408404,0.0018070352674852271,0.3733423943503293,0.0022832501858513774,0.0023029776451034,0.001612516571282625,0.33008732778674665,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705,0.00000031970379943603705} 

		},

{ // branch
  
{0.4961272737511179,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.3378738112068251,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.16324664745547282,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468,0.00004511914076367468},
{0.000012848208870044849,0.4940502833079855,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.2955475478346784,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.20961842811626336,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849,0.000012848208870044849},
{0.00002206002309975132,0.00002206002309975132,0.6462748829365208,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.26943889903725954,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.08294055661713479,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132,0.00002206002309975132},
{0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.5588711662043978,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.31423239565522076,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.12582713422882724,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706,0.000017529572320560706},
{0.4110007742933002,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.34346743680032765,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.24521255418044952,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634,0.00000523335616266634},
{0.00008804529213632688,0.4981718657752934,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.26504090010954473,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.23141647129484594,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688,0.00008804529213632688},
{0.0000118397633956368,0.0000118397633956368,0.5629538575968327,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.3023276240586929,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.1339962927773405,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368,0.0000118397633956368},
{0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.42810264428102646,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.342311355162244,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.22854934532897173,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437,0.000016994347996030437},
{0.4178246927525718,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.3452172586312796,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.23646820568273827,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789,0.000008030212023119789},
{0.000010131008866281992,0.435982312043869,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.267353711373369,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.2960459850419188,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992,0.000010131008866281992},
{0.00007649281056525816,0.00007649281056525816,0.5951864082356073,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.2757992757494665,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.12434825457044543,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816,0.00007649281056525816},
{0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.4036381513070509,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.35636613699532466,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.2390456933588539,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486,0.000015574071127386486},
{0.27237233545810213,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.30771667898339283,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.41952895828848674,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093,0.000006262742131447093},
{0.000008723154070713945,0.24470624575802824,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.24027251674287706,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.5144891251007812,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945,0.000008723154070713945},
{0.000010151113089222933,0.000010151113089222933,0.43288390919522446,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.30183610815452294,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.26466076475181,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933,0.000010151113089222933},
{0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.3925592397164625,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.34289543228862845,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.2601984674126319,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686,0.00007126000954552686} 

	},


    {// stickPmf

{0.000013857444068562766,0.31138869206782716,0.26337082219545743,0.15048131522398142,0.000013857444068562766,0.05602553894715222,0.0703849662415475,0.058116509092846595,0.000013857444068562766,0.038663343171760546,0.026567942940846117,0.0242387106948101,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766,0.000013857444068562766},
{0.11964644452048286,0.00001658786146589632,0.3257288918498436,0.24501492971825967,0.07468986806992259,0.00001658786146589632,0.07473538824789877,0.06654059891952585,0.0454238655092197,0.00001658786146589632,0.0235006277026802,0.023807053081542455,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632,0.00001658786146589632},
{0.12014826010580533,0.17048067005588166,0.000017248253714591943,0.4554279719610248,0.06579500142933203,0.05698702690647355,0.000017248253714591943,0.039481787582273505,0.03701020642014767,0.034395692054759064,0.000017248253714591943,0.019324729529999793,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943,0.000017248253714591943},
{0.15841100999509106,0.16933788901784858,0.22434304901939223,0.00002676478484640126,0.10016585867446677,0.07262842220970894,0.08658470141496497,0.00002676478484640126,0.06685552784097817,0.07385337794407447,0.046348100716922774,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126,0.00002676478484640126},
{0.000017011196136322187,0.1815072209890204,0.34480771480162636,0.1335501535557158,0.000017011196136322187,0.09417516863831704,0.057388522928389064,0.04700602288652042,0.000017011196136322187,0.10031739727116677,0.019451973107540693,0.02086021003420569,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187,0.000017011196136322187},
{0.2911288004444792,0.000021837986517328695,0.2806782235322757,0.15475920826633813,0.06985887243534855,0.000021837986517328695,0.0760698328022809,0.044733337870217355,0.031157220298560825,0.000021837986517328695,0.029437267251924706,0.020976147840121563,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695,0.000021837986517328695},
{0.5300091890108855,0.09719517676612065,0.000011690161777339573,0.1832911339638167,0.037636521152849316,0.04719562987316628,0.000011690161777339573,0.0294785100390397,0.017558079261109277,0.042861479738865345,0.000011690161777339573,0.01413132129639363,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573,0.000011690161777339573},
{0.3148330783078198,0.13046583766925446,0.20539265034259688,0.00003143649426064655,0.05151003616171615,0.06803101051757873,0.07661950948833816,0.00003143649426064655,0.03594775303392631,0.06891025758186099,0.04656085971257296,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655,0.00003143649426064655},
{0.000023254623343603823,0.3565463747664623,0.19995983620092284,0.15376768162581905,0.000023254623343603823,0.05525100211202455,0.08176469782329515,0.04981645071714374,0.000023254623343603823,0.042050488130768136,0.03867315969400521,0.02089130464566083,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823,0.000023254623343603823},
{0.23900263866970672,0.000009327242619801202,0.1097661002306938,0.41915095484211873,0.05857732508274855,0.000009327242619801202,0.03788704260901341,0.07888627517216716,0.018488763998636634,0.000009327242619801202,0.016078792496616524,0.02164910855420943,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202,0.000009327242619801202},
{0.2912492665831692,0.16535975412651335,0.00001589763010700584,0.3004786419036636,0.05484337322077482,0.049120842569466173,0.00001589763010700584,0.04160175647862317,0.030011644705959774,0.04613405990843211,0.00001589763010700584,0.02032629084751252,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584,0.00001589763010700584},
{0.3339681717237846,0.1639033691947005,0.1565560484110952,0.00003010814425302044,0.06668043705822425,0.05505939356595959,0.06706390745363287,0.00003010814425302044,0.05638158455195464,0.06413804934234711,0.0345930907643851,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044,0.00003010814425302044},
{0.00002513002352092279,0.1872311428394433,0.28995625038230755,0.1588092810436635,0.00002513002352092279,0.06090231979338056,0.07055283324456656,0.10166847771668217,0.00002513002352092279,0.04173317681289743,0.029360438953328676,0.058403927920079514,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279,0.00002513002352092279},
{0.21759541628766282,0.00002516936642266039,0.3178385640739878,0.11110441228748957,0.07145485571709476,0.00002516936642266039,0.09174156016512665,0.06942140504378494,0.03766273751394558,0.00002516936642266039,0.03969970019187252,0.04209703356578902,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039,0.00002516936642266039},
{0.3207972019267704,0.16608273093874515,0.000021581809445672062,0.15640203464599808,0.07644092874723786,0.06227121608979103,0.000021581809445672062,0.0785129497548708,0.04436768309739452,0.05766977355495565,0.000021581809445672062,0.03626848172472452,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062,0.000021581809445672062},
{0.24020734352938963,0.11235699273030741,0.2052876130172515,0.000021280045898914504,0.09195008855963288,0.055082161597369325,0.08305321479632934,0.000021280045898914504,0.0861668649230116,0.06880020296874786,0.05592511535352012,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504,0.000021280045898914504} 

}};

static constexpr const double transProbs[CONTEXT_NUMBER][4] = {
{0.953445859877713,0.006836455286467697,0.022303818437255703,0.017413866398563554}, // AA
{0.9003163418403966,0.031019044329166686,0.02402019677693086,0.044644417053505955}, // AC
{0.8898817769984686,0.01973143779015963,0.025243726977289986,0.06514305823408183}, // AG
{0.8960092058980452,0.019270280991747844,0.012613585507766726,0.07210692760244015}, // AT
{0.8402162704235043,0.05878685470843993,0.018071660883302258,0.08292521398475348}, // CA
{0.9669029915640793,0.004400791619857565,0.01781849700777379,0.010877719808289315}, // CC
{0.876078326174483,0.024775242738329588,0.02509253749658318,0.07405389359060424}, // CG
{0.8998682923983953,0.025684059467897633,0.01387177465755109,0.06057587347615596}, // CT
{0.8481839446059074,0.04698716706612444,0.016209640376035887,0.08861924795193224}, // GA
{0.9056669449245583,0.026051214738268342,0.028297609876681677,0.03998423046049161}, // GC
{0.9575480995655864,0.005033507083988975,0.024313537140274927,0.01310485621014973}, // GG
{0.9029579981473387,0.025937214192961393,0.013404077506724272,0.05770071015297563}, // GT
{0.8417024724516179,0.0743863705635533,0.01851569693227244,0.06539546005255636}, // TA
{0.9101159462491903,0.043436290991024654,0.015038218040010962,0.031409544719774016}, // TC
{0.9124477377424721,0.03125965356143372,0.014692372668997786,0.04160023602709638}, // TG
{0.9735228537300266,0.004353973680168022,0.014626904566900432,0.007496268022905023}, // TT
    };

inline double CalculateExpectedLLForEmission(const size_t move, const uint8_t row,
                                             const size_t moment)
{
    double expectedLL = 0;
    for (size_t i = 0; i < OUTCOME_NUMBER; i++) {
        double curProb = emissionPmf[move][row][i];
        double lgCurProb = std::log(curProb);
        if (!std::isfinite(lgCurProb)) continue;
        if (moment == static_cast<uint8_t>(MomentType::FIRST))
            expectedLL += curProb * lgCurProb;
        else if (moment == static_cast<uint8_t>(MomentType::SECOND))
            expectedLL += curProb * (lgCurProb * lgCurProb);
    }
    return expectedLL;
}

Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model::Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model(const NucleotideLevelFeats& feats){
    for (size_t ctx = 0; ctx < CONTEXT_NUMBER; ++ctx) {
        const uint8_t bp = ctx & 3;  // (equivalent to % 4)
        double sum = 0.0;

        // cached transitions
        for (size_t j = 0; j < 4; ++j) {
            double xb = transProbs[ctx][j];
            ctxTrans_[ctx][j] = xb;
            sum += xb;
        }
        for (size_t j = 0; j < 4; ++j)
            ctxTrans_[ctx][j] /= sum;

        // cached expectations
        for (size_t move = 0; move < 3; ++move)
            for (size_t moment = 0; moment < 2; ++moment)
                cachedEmissionExpectations_[ctx][move][moment] =
                    CalculateExpectedLLForEmission(move, ctx, moment);
    }
}

std::unique_ptr<AbstractRecursor> Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model::CreateRecursor(const MappedRead& mr,
                                                                 double scoreDiff) const
{
    const double counterWeight = CounterWeight(
        [this](size_t ctx, MoveType m) { return ctxTrans_[ctx][static_cast<uint8_t>(m)]; },
        [](size_t ctx, MoveType m) {
            double r = 0.0;
            for (size_t o = 0; o < OUTCOME_NUMBER; ++o) {
                const double p = emissionPmf[static_cast<uint8_t>(m)][ctx][o];
                if (p > 0.0) r += p * std::log(p);
            }
            return r;
        },
        CONTEXT_NUMBER);

    return std::make_unique<Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor>(mr, scoreDiff, counterWeight);
}

std::vector<TemplatePosition> Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model::Populate(const std::string& tpl) const
{
    auto rowFetcher = [this](const NCBI2na prev, const NCBI2na curr) -> const double(&)[4]
    {
        const auto row = EncodeContext16(prev, curr);
        const double(&params)[4] = ctxTrans_[row];
        return params;
    };
    return AbstractPopulater(tpl, rowFetcher);
}

double Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model::ExpectedLLForEmission(const MoveType move, const AlleleRep& prev,
                                             const AlleleRep& curr, const MomentType moment) const
{
    auto cachedEmissionVisitor = [this](const MoveType move, const NCBI2na prev, const NCBI2na curr,
                                        const MomentType moment) -> double {
        const auto row = EncodeContext16(prev, curr);
        return cachedEmissionExpectations_[row][static_cast<uint8_t>(move)]
                                          [static_cast<uint8_t>(moment)];
    };
    return AbstractExpectedLLForEmission(move, prev, curr, moment, cachedEmissionVisitor);
}

Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor::Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor(const MappedRead& mr, double scoreDiff, double counterWeight)
    : Recursor<Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor>(mr, scoreDiff)
    , counterWeight_{counterWeight}
    , nLgCounterWeight_{-std::log(counterWeight_)}
{
}

std::vector<uint8_t> Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor::EncodeRead(const MappedRead& read)
{
    std::vector<uint8_t> result;
    result.reserve(read.Length());
    std::vector<uint8_t> pw_boundaries = {18, 46};
    std::vector<uint8_t> cr_boundaries = {255};
    for (size_t i = 0; i < read.Length(); ++i) {
        result.emplace_back(EncodeBaseV3(read.Seq[i], read.PulseWidth[i], pw_boundaries, read.CR[i], cr_boundaries));
    }

    return result;
}

double Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor::EmissionPr(const MoveType move, const uint8_t emission,
                                     const AlleleRep& prev, const AlleleRep& curr) const
{
    return AbstractEmissionPrV2(emissionPmf, move, emission, prev, curr) * counterWeight_;
}

double Kit__500_Chem__1_BC__1_PW3__nodel_sf_Recursor::UndoCounterWeights(const size_t nEmissions) const
{
    return nLgCounterWeight_ * nEmissions;
}

inline std::pair<Data::SNR, std::vector<TemplatePosition>> Kit__500_Chem__1_BC__1_PW3__nodel_sf_InitialiseModel(
    std::default_random_engine* const rng, const std::string& tpl)
{
    Data::SNR snrs{0, 0, 0, 0};
    for (uint8_t i = 0; i < 4; ++i) {
        snrs[i] = std::uniform_real_distribution<double>{snrRanges[0][i], snrRanges[1][i]}(*rng);
    }


    Data::NucleotideLevelFeats feats;

    const Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model model{feats};
    std::vector<TemplatePosition> transModel = model.Populate(tpl);

    return {snrs, transModel};
}

BaseData Kit__500_Chem__1_BC__1_PW3__nodel_sf_GenerateReadData(std::default_random_engine* const rng, const MoveType state,
                                   const AlleleRep& prev, const AlleleRep& curr)
{
    // distribution is arbitrary at the moment, as
    // IPD is not a covariate of the consensus HMM
    std::uniform_int_distribution<uint8_t> ipdDistrib(1, 5);

    std::array<double, OUTCOME_NUMBER> emissionDist;
    for (size_t i = 0; i < OUTCOME_NUMBER; ++i) {
        emissionDist[i] = AbstractEmissionPrV2(emissionPmf, state, i, prev, curr);
    }

    std::discrete_distribution<uint8_t> outcomeDistrib(emissionDist.cbegin(), emissionDist.cend());

    const uint8_t event = outcomeDistrib(*rng);
    const std::pair<char, uint8_t> outcome = DecodeEmission(event);

    return {outcome.first, outcome.second, ipdDistrib(*rng)};
}

std::pair<Data::Read, std::vector<MoveType>> Kit__500_Chem__1_BC__1_PW3__nodel_sf_Model::SimulateRead(
    std::default_random_engine* const rng, const std::string& tpl,
    const std::string& readname) const
{
    return SimulateReadImpl(rng, tpl, readname, Kit__500_Chem__1_BC__1_PW3__nodel_sf_InitialiseModel,
                            Kit__500_Chem__1_BC__1_PW3__nodel_sf_GenerateReadData);
}

}  // namespace anonymous
}  // namespace S_P2C2v5

REGISTER_MODEL_IMPL(Kit__500_Chem__1_BC__1_PW3__nodel_sf)

}  // namespace Consensus
}  // namespace PacBio
